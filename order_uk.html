<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrintMediaPro - Форма замовлення друкарських послуг</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #4F46E5;
            --secondary: #6B7280;
            --success: #10B981;
            --danger: #EF4444;
            --background: #D1D5DB;
            --white: #FFFFFF;
            --text: #1F2937;
            --border: #9CA3AF;
            --card-bg: #E5E7EB;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--background) url('https://printtmedia.github.io/printmediapro/5073412.png') no-repeat center center fixed;
            background-size: cover;
            margin: 0;
            padding: 0;
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .order-form {
            max-width: 1100px;
            width: 100%;
            margin: 60px auto 0;
            padding: 1rem;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            z-index: 500;
            min-height: 400px;
            max-height: calc(100vh - 80px);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
        }

        .order-form-content {
            flex: 1;
        }

        .order-form-buttons {
            padding: 1rem 0;
            text-align: center;
        }

        .content-spacer {
            height: 100vh;
            visibility: hidden;
        }

        .logo {
            display: none;
        }

        h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            text-align: center;
            margin-bottom: 1rem;
            margin-top: 0;
            letter-spacing: 0.025em;
        }

        .form-group {
            margin-bottom: 0.75rem;
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 0.5rem;
            align-items: center;
            max-width: 100%;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary);
            margin: 1rem 0 0.5rem;
            padding-bottom: 0.25rem;
            border-bottom: 2px solid var(--primary);
        }

        label {
            font-weight: 500;
            color: var(--secondary);
            font-size: 0.9rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--white);
            font-size: 0.9rem;
            transition: all 0.2s ease;
            color: #1F2937;
            box-sizing: border-box;
            max-width: 100%;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .custom-field, .binding-options {
            display: none;
            grid-column: 2 / 3;
            margin-top: 0.25rem;
            max-width: 100%;
        }

        button {
            background: var(--primary);
            color: var(--white);
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 0 5px;
            font-size: 0.9rem;
            box-sizing: border-box;
        }

        button:hover {
            background: #4338CA;
            transform: translateY(-1px);
        }

        .remove-button {
            background: var(--danger);
            padding: 0.25rem 0.5rem;
            margin-left: 0.5rem;
            font-size: 0.8rem;
        }

        .remove-button:hover {
            background: #DC2626;
        }

        .selected-items {
            grid-column: 2 / 3;
            margin-top: 0.25rem;
            max-width: 100%;
            word-break: break-word;
        }

        .selected-item {
            display: flex;
            align-items: center;
            background: #F3F4F6;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            margin-bottom: 0.25rem;
            border: 1px solid var(--border);
            font-size: 0.85rem;
            max-width: 100%;
            box-sizing: border-box;
        }

        .file-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            max-width: 100%;
        }

        /* Navigation */
        :root {
            --nav-primary: #FF6200;
            --nav-secondary: #D81B60;
            --nav-text: #1A237E;
            --nav-background: #1C2526;
            --nav-white: #FFFFFF;
            --nav-hover: #E65100;
            --nav-card-bg: #F8FAFA;
            --nav-accent-bg: #E8ECEF;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        nav {
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            padding: 0.75rem 0;
            animation: slideDown 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        nav .container {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            flex-direction: row;
            position: relative;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        nav a {
            color: var(--nav-white);
            text-decoration: none;
            font-weight: 500;
            font-size: 1rem;
            text-transform: uppercase;
            transition: color 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        nav a:hover {
            color: var(--nav-primary);
        }

        .menu-toggle {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--nav-white);
        }

        /* Language Switcher */
        .language-toggle {
            background: transparent;
            border: 1px solid var(--nav-white);
            color: var(--nav-white);
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .language-toggle:focus {
            outline: none;
            border-color: var(--nav-primary);
        }

        .language-toggle option {
            background: var(--nav-background);
            color: var(--nav-white);
        }

        /* Dropdown Menu */
        .dropdown {
            position: relative;
        }

        .dropdown-toggle {
            cursor: pointer;
            color: var(--nav-white);
            font-weight: 500;
            font-size: 1rem;
            text-transform: uppercase;
            transition: color 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-block;
        }

        .dropdown-toggle:hover {
            color: var(--nav-primary);
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: var(--nav-background);
            list-style: none;
            min-width: 200px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            animation: fadeIn 0.3s ease-in-out;
        }

        .dropdown-menu li {
            padding: 0.5rem 1rem;
        }

        .dropdown-menu li a {
            color: var(--nav-white);
            font-size: 0.9rem;
            text-transform: none;
            display: block;
        }

        .dropdown-menu li a:hover {
            color: var(--nav-primary);
        }

        .dropdown:hover .dropdown-menu {
            display: block;
        }

        /* Animations */
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @media (max-width: 768px) {
            body {
                overflow-x: hidden;
            }

            .order-form {
                width: 100vw;
                max-width: none;
                padding: 0.5rem;
                margin: 60px 0 0;
                position: fixed;
                top: 0;
                left: 0;
                transform: none;
                min-height: 300px;
                max-height: calc(100vh - 60px);
                overflow-y: auto;
                overflow-x: hidden;
                box-sizing: border-box;
            }

            .form-group {
                grid-template-columns: 1fr;
                gap: 0.25rem;
                max-width: 100%;
                margin-bottom: 0.5rem;
            }

            .form-group label, 
            .form-group input, 
            .form-group select, 
            .form-group textarea,
            .custom-field,
            .binding-options,
            .selected-items,
            .selected-item,
            .file-group {
                max-width: 100%;
                width: 100%;
                box-sizing: border-box;
                word-break: break-word;
            }

            .order-form-content,
            .order-form-buttons {
                padding: 0 0.25rem;
            }

            .section-title {
                margin: 0.5rem 0 0.25rem;
            }

            h2 {
                font-size: 1rem;
            }

            label, input, select, textarea, button {
                font-size: 0.8rem;
            }

            .remove-button {
                font-size: 0.7rem;
                padding: 0.2rem 0.4rem;
            }

            .selected-item {
                font-size: 0.75rem;
                padding: 0.2rem 0.4rem;
            }

            .file-group {
                flex-direction: column;
                align-items: flex-start;
            }

            nav {
                padding: 0.5rem 0;
            }

            nav ul {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: var(--nav-background);
                padding: 1.5rem;
                text-align: center;
            }

            nav ul.active {
                display: flex;
            }

            .menu-toggle {
                display: block;
                position: fixed;
                right: 1.5rem;
                top: 1rem;
                z-index: 1002;
                font-size: 2rem;
                color: var(--nav-white);
                background: rgba(28, 37, 38, 0.9);
                padding: 0.5rem;
                border-radius: 8px;
            }

            .dropdown-menu {
                position: static;
                box-shadow: none;
                background: transparent;
                padding: 0.5rem 0;
                min-width: 100%;
                display: none;
            }

            .dropdown-menu.active {
                display: block;
            }

            .dropdown-menu li {
                padding: 0.5rem 0;
            }

            .dropdown-menu li a {
                font-size: 1rem;
                text-transform: uppercase;
            }

            .language-toggle {
                margin-top: 1rem;
                width: 100%;
                text-align: center;
            }
        }

        @media print {
            body {
                background: none !important;
            }
            .order-form {
                background: var(--card-bg) !important;
                position: static !important;
                transform: none !important;
                margin: 0 !important;
                max-width: 100% !important;
                padding: 1rem !important;
                overflow: visible !important;
            }
            .logo {
                display: block !important;
                position: absolute;
                top: 20px;
                left: 20px;
                width: 150px;
                height: auto;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .order-table {
                font-size: 12pt !important;
                width: 100% !important;
            }
            table, th, td {
                border: 1px solid black !important;
                font-weight: 600 !important;
            }
            nav {
                display: none !important;
            }
            .content-spacer {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <div class="menu-toggle">
                <i class="fas fa-bars"></i>
            </div>
            <ul>
                <li><a href="index.html#home">Головна</a></li>
                <li><a href="index.html#services">Послуги</a></li>
                <li><a href="index.html#about">Про нас</a></li>
                <li><a href="index.html#contact">Контакти</a></li>
                <li><a href="order_uk.html">Замовлення</a></li>
                <li class="dropdown">
                    <span class="dropdown-toggle">Вимоги до макетів</span>
                    <ul class="dropdown-menu">
                        <li><a href="requirements.html">Офсетний друк</a></li>
                        <li><a href="sticker_requirements.html">Вимоги до наклейок</a></li>
                        <li><a href="varnish_foil_requirements.html">Підготовка макетів: лак і фольга</a></li>
                    </ul>
                </li>
                <li>
                    <select class="language-toggle" onchange="window.location.href=this.value">
                        <option value="order_uk.html" selected>UK</option>
                        <option value="order_en.html">EN</option>
                        <option value="order_ru.html">RU</option>
                    </select>
                </li>
            </ul>
        </div>
    </nav>

    <div class="order-form">
        <div class="order-form-content">
            <img src="https://printtmedia.github.io/printmediapro/Logo%20printmediapro.png" alt="Логотип PrintMediaPro" class="logo">
            <h2>ФОРМА ЗАМОВЛЕННЯ № <span id="orderNumber"></span></h2>

            <div class="form-group">
                <label>Дата замовлення:</label>
                <input type="date" id="orderDate" name="order_date" required>
            </div>

            <div class="form-group">
                <label>Замовник:</label>
                <input type="text" name="customer" placeholder="Назва компанії" required>
            </div>

            <div class="form-group">
                <label>Контактна особа:</label>
                <input type="text" name="contact_person" placeholder="Іван Іванов" required>
            </div>

            <div class="form-group">
                <label>Телефон:</label>
                <input type="tel" name="phone" pattern="[+]{1}[0-9]{12}" placeholder="+380XXXXXXXXX" required>
            </div>

            <div class="form-group">
                <label>Email:</label>
                <input type="email" name="email" placeholder="example@domain.com" required>
            </div>

            <div class="form-group">
                <label>Назва файлу:</label>
                <div class="file-group">
                    <input type="file" id="fileUpload" accept=".pdf,.jpg,.png,.docx" multiple>
                </div>
                <div id="fileList" class="selected-items"></div>
            </div>

            <div class="section-title">Специфікація продукту</div>

            <div class="form-group">
                <label>Назва продукту:</label>
                <select name="product_name" id="productName" required>
                    <option value="">Виберіть продукт</option>
                    <option value="label">Етикетка</option>
                    <option value="booklet">Буклет</option>
                    <option value="brochure">Брошура</option>
                    <option value="flyer">Флаєр</option>
                    <option value="euro_flyer">Єврофлаєр</option>
                    <option value="catalog">Каталог</option>
                    <option value="magazine">Журнал</option>
                    <option value="book">Книга</option>
                    <option value="calendar">Календар</option>
                    <option value="newspaper">Газета</option>
                    <option value="poster">Плакат</option>
                    <option value="board">Дошка</option>
                    <option value="banner">Банер</option>
                    <option value="leaflet">Листівка</option>
                    <option value="business_card">Візитка</option>
                    <option value="certificate">Сертифікат</option>
                    <option value="pvc_table">ПВХ таблиця</option>
                    <option value="cutting">Плотерна різка</option>
                    <option value="stopper">Стоппер</option>
                    <option value="other">Інше</option>
                </select>
                <div id="bindingOptions" class="binding-options">
                    <label>Тип:</label>
                    <select id="bindingType">
                        <option value="">Виберіть тип палітурки</option>
                        <option value="soft">М'яка палітурка</option>
                        <option value="hard">Тверда палітурка</option>
                    </select>
                </div>
                <div id="calendarOptions" class="binding-options">
                    <label>Тип календаря:</label>
                    <select id="calendarType">
                        <option value="">Виберіть тип</option>
                        <option value="cover">Обкладинка</option>
                        <option value="inner">Внутрішній блок</option>
                    </select>
                    <label>Кількість сторінок:</label>
                    <input type="number" id="pageCount" min="1" placeholder="Введіть кількість сторінок">
                </div>
                <input type="text" name="custom_product" 
                       class="custom-field" 
                       placeholder="Вкажіть назву продукту"
                       id="customProduct">
                <div id="selectedProducts" class="selected-items"></div>
            </div>

            <div class="form-group">
                <label>Сторони друку:</label>
                <select name="print_sides" id="printSides">
                    <option value="">Виберіть тип друку</option>
                    <option value="4+0">Односторонній (4+0)</option>
                    <option value="4+4">Двосторонній (4+4)</option>
                </select>
                <div id="selectedPrintSides" class="selected-items"></div>
            </div>

            <div class="form-group">
                <label>Кількість:</label>
                <input type="number" name="quantity" min="1" required>
            </div>

            <div class="form-group">
                <label>Формат:</label>
                <select name="format" id="formatSelect">
                    <option value="">Виберіть формат</option>
                    <option value="A1">A1</option>
                    <option value="A2">A2</option>
                    <option value="A3">A3</option>
                    <option value="A4">A4</option>
                    <option value="A5">A5</option>
                    <option value="A6">A6</option>
                    <option value="custom">Власний формат</option>
                </select>
                <input type="text" name="custom_format" 
                       class="custom-field" 
                       placeholder="Вкажіть розміри (мм)"
                       id="customFormat">
                <div id="selectedFormats" class="selected-items"></div>
            </div>

            <div class="form-group">
                <label>Тип друку:</label>
                <select name="print_type" id="printType">
                    <option value="">Виберіть тип друку</option>
                    <option value="konica">Konica</option>
                    <option value="konica_label">Етикетка Konica</option>
                    <option value="wide_format">Широкоформатний друк</option>
                    <option value="plotter_cutting">Плотерна різка</option>
                    <option value="newspaper_printing">Друк газет</option>
                    <option value="heidelberg_printing">Друк Heidelberg</option>
                </select>
                <div id="selectedPrintTypes" class="selected-items"></div>
            </div>

            <div class="form-group">
                <label>Матеріал:</label>
                <select name="material" id="materialSelect">
                    <option value="">Виберіть матеріал</option>
                    <option value="offset">Офсет</option>
                    <option value="glossy_chalk">Глянцева крейда</option>
                    <option value="matte_chalk">Матова крейда</option>
                    <option value="self_adhesive">Самоклеючий</option>
                    <option value="blueback">Blueback</option>
                    <option value="citylight">Citylight</option>
                    <option value="banner">Банер</option>
                    <option value="film_white">Плівка: Біла</option>
                    <option value="film_matte">Плівка: Матова</option>
                    <option value="perforated_film">Перфорована плівка</option>
                    <option value="orafol_soundproof">Плівка: Orafol звукоізоляційна</option>
                    <option value="film_label_white_propylene">Плівка: Білий пропілен</option>
                    <option value="film_linen">Плівка: Льон</option>
                    <option value="film_kraft">Плівка: Крафт</option>
                    <option value="film_grey_propylene">Плівка: Сірий пропілен</option>
                    <option value="film_transparent_propylene">Плівка: Прозорий пропілен</option>
                    <option value="newspaper">Газетний папір</option>
                    <option value="design_cardboard">Дизайнерський картон</option>
                    <option value="other">Інший матеріал</option>
                </select>
                <input type="text" name="custom_material" 
                       class="custom-field" 
                       placeholder="Вкажіть матеріал"
                       id="customMaterial">
                <div id="selectedMaterials" class="selected-items"></div>
            </div>

            <div class="form-group">
                <label>Щільність паперу:</label>
                <select id="paperWeightSelect" name="paper_weight">
                    <option value="">Виберіть щільність</option>
                    <option value="70">70 г/м²</option>
                    <option value="80">80 г/м²</option>
                    <option value="90">90 г/м²</option>
                    <option value="115">115 г/м²</option>
                    <option value="130">130 г/м²</option>
                    <option value="150">150 г/м²</option>
                    <option value="200">200 г/м²</option>
                    <option value="250">250 г/м²</option>
                    <option value="300">300 г/м²</option>
                    <option value="350">350 г/м²</option>
                    <option value="other">Інша</option>
                </select>
                <input type="text" name="custom_paper_weight" 
                       class="custom-field" 
                       placeholder="Вкажіть щільність (г/м²)"
                       id="customPaperWeight">
                <div id="selectedPaperWeights" class="selected-items"></div>
            </div>

            <div class="form-group">
                <label>Термін виконання:</label>
                <input type="date" name="deadline" required>
            </div>

            <div class="section-title">Післядрукарська обробка</div>
            <div class="form-group">
                <label>Післядрукарська обробка:</label>
                <select id="postPrintSelect">
                    <option value="">Виберіть тип обробки</option>
                    <option value="folding">Фальцювання</option>
                    <option value="creasing">Біговка</option>
                    <option value="stapling">Скріплення</option>
                    <option value="binding">Палітурка</option>
                    <option value="perforation">Перфорація</option>
                    <option value="die_cutting">Висічка</option>
                    <option value="spring">Пружинна палітурка</option>
                    <option value="guillotine">Гільйотинна різка</option>
                    <option value="manual_cutting">Ручна різка</option>
                    <option value="plotter_cutting">Плотерна різка</option>
                    <option value="film_lamination">Ламінація плівкою на ПВХ</option>
                    <option value="banner_gluing">Склеювання банера</option>
                    <option value="eyelets">Люверси</option>
                    <option value="glossy_lamination">Глянцева ламінація</option>
                    <option value="matte_lamination">Матова ламінація</option>
                    <option value="velvet_lamination">Оксамитова ламінація</option>
                    <option value="double_sided_lamination">Двостороння ламінація</option>
                    <option value="pockets">Кишені</option>
                    <option value="other">Інше</option>
                </select>
                <input type="text" id="customPostPrint" name="custom_post_print" 
                       class="custom-field" placeholder="Вкажіть тип обробки" style="display: none;">
                <div id="selectedPostPrint" class="selected-items"></div>
            </div>

            <div id="eyeletsFields" style="display: none; margin-top: 5px;">
                <label for="eyeletsQuantity">Кількість люверсів:</label>
                <input type="number" id="eyeletsQuantity" name="eyelets_quantity" min="1" placeholder="Введіть кількість">
                <label for="eyeletsDistance">Відстань між люверсами (мм):</label>
                <input type="number" id="eyeletsDistance" name="eyelets_distance" min="1" placeholder="Введіть відстань">
            </div>

            <div id="pocketsFields" style="display: none; margin-top: 5px;">
                <label for="pocketSize">Розмір кишені (мм):</label>
                <input type="text" id="pocketSize" name="pocket_size" placeholder="Напр., 100x50">
                <label for="noodleColor">Колір нитки для кишені:</label>
                <select id="noodleColor" name="noodle_color">
                    <option value="">Виберіть колір</option>
                    <option value="white">Білий</option>
                    <option value="black">Чорний</option>
                    <option value="red">Червоний</option>
                    <option value="blue">Синій</option>
                    <option value="green">Зелений</option>
                    <option value="yellow">Жовтий</option>
                    <option value="custom">Власний</option>
                </select>
                <input type="text" id="customNoodleColor" name="custom_noodle_color" 
                       class="custom-field" placeholder="Вкажіть колір" style="display: none;">
            </div>

            <div class="form-group">
                <label>Примітки:</label>
                <textarea name="notes" rows="3" placeholder="Додаткові побажання"></textarea>
            </div>
        </div>

        <div class="order-form-buttons">
            <button type="button" onclick="sendOrder()">Друкувати форму замовлення</button>
            <button type="button" onclick="sendToGmail()">Надіслати на Gmail</button>
            <button type="button" onclick="showInstructions()">Інструкції</button>
        </div>
    </div>
    <div class="content-spacer"></div>

    <script>
        let selectedFiles = [];

        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded');
            document.getElementById('orderDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('orderNumber').textContent = 
                Math.floor(Math.random() * 100000000).toString().padStart(8, '0');

            setupFileUpload();
            setupMultipleSelect('productName', 'selectedProducts', handleProductChange);
            setupMultipleSelect('printSides', 'selectedPrintSides');
            setupMultipleSelect('formatSelect', 'selectedFormats', handleFormatChange);
            setupMultipleSelect('printType', 'selectedPrintTypes', handlePrintTypeChange);
            setupMultipleSelect('materialSelect', 'selectedMaterials', handleMaterialChange);
            setupMultipleSelect('paperWeightSelect', 'selectedPaperWeights', handlePaperWeightChange);
            setupMultipleSelect('postPrintSelect', 'selectedPostPrint', handlePostPrintChange);

            document.querySelector('input[name="phone"]').addEventListener('input', function(e) {
                console.log('Phone input changed:', this.value);
                this.value = this.value.replace(/[^\d+]/g, '');
            });

            setupBindingTypeHandler();
            setupCalendarTypeHandler();

            // Hamburger Menu
            const menuToggle = document.querySelector('.menu-toggle');
            const navUl = document.querySelector('nav ul');

            menuToggle.addEventListener('click', () => {
                console.log('Menu toggle clicked');
                navUl.classList.toggle('active');
            });

            // Dropdown Menu for Mobile
            const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
            dropdownToggles.forEach(toggle => {
                toggle.addEventListener('click', (e) => {
                    if (window.innerWidth <= 768) {
                        console.log('Dropdown toggle clicked');
                        e.preventDefault();
                        const dropdownMenu = toggle.nextElementSibling;
                        dropdownMenu.classList.toggle('active');
                    }
                });
            });
        });

        function setupFileUpload() {
            const fileInput = document.getElementById('fileUpload');
            const fileList = document.getElementById('fileList');

            fileInput.addEventListener('change', function() {
                console.log('File input changed, files:', this.files);
                const newFiles = Array.from(this.files);
                newFiles.forEach(file => {
                    if (!selectedFiles.some(existingFile => existingFile.name === file.name)) {
                        selectedFiles.push(file);
                        addItem(fileList, file.name, 'removeFile', file.name);
                    }
                });
                this.value = '';
            });

            window.removeFile = function(button, fileName) {
                console.log('Removing file:', fileName);
                selectedFiles = selectedFiles.filter(file => file.name !== fileName);
                button.parentElement.remove();
            };
        }

        function setupMultipleSelect(selectId, containerId, customHandler) {
            const select = document.getElementById(selectId);
            const container = document.getElementById(containerId);

            select.addEventListener('change', function() {
                const value = this.value;
                console.log(`Select ${selectId} changed to:`, value);
                if (!value) return;

                if (customHandler) {
                    customHandler(value, container);
                } else {
                    const text = this.options[this.selectedIndex].text;
                    addItem(container, text, `remove${selectId.charAt(0).toUpperCase() + selectId.slice(1)}`, text);
                }
                this.value = '';
            });
        }

        function handleProductChange(value, container) {
            console.log('Handling product change:', value);
            const bindingOptions = document.getElementById('bindingOptions');
            const calendarOptions = document.getElementById('calendarOptions');
            const customProduct = document.getElementById('customProduct');

            bindingOptions.style.display = (value === 'magazine' || value === 'book') ? 'block' : 'none';
            calendarOptions.style.display = value === 'calendar' ? 'block' : 'none';
            customProduct.style.display = value === 'other' ? 'block' : 'none';

            if (value === 'other') {
                customProduct.addEventListener('blur', function handler() {
                    if (this.value) {
                        console.log('Custom product added:', this.value);
                        addItem(container, this.value, 'removeProduct', this.value);
                        this.value = '';
                    }
                    this.removeEventListener('blur', handler);
                });
            } else if (value !== 'magazine' && value !== 'book' && value !== 'calendar') {
                const text = document.getElementById('productName').options[document.getElementById('productName').selectedIndex].text;
                addItem(container, text, 'removeProduct', text);
            }
        }

        function setupBindingTypeHandler() {
            const bindingType = document.getElementById('bindingType');
            const container = document.getElementById('selectedProducts');
            bindingType.addEventListener('change', function() {
                if (this.value) {
                    console.log('Binding type changed:', this.value);
                    const productName = document.getElementById('productName').value === 'magazine' ? 'Журнал' : 'Книга';
                    const bindingText = this.options[this.selectedIndex].text;
                    addItem(container, `${productName} (${bindingText})`, 'removeProduct', `${productName} (${bindingText})`);
                    this.value = '';
                }
            });
        }

        function setupCalendarTypeHandler() {
            const calendarType = document.getElementById('calendarType');
            const pageCount = document.getElementById('pageCount');
            const container = document.getElementById('selectedProducts');
            calendarType.addEventListener('change', function() {
                if (this.value) {
                    console.log('Calendar type changed:', this.value);
                    const calendarText = this.options[this.selectedIndex].text;
                    const pages = pageCount.value ? `, ${pageCount.value} сторінок` : '';
                    addItem(container, `Календар (${calendarText}${pages})`, 'removeProduct', `Календар (${calendarText}${pages})`);
                    this.value = '';
                    pageCount.value = '';
                }
            });
        }

        function handleFormatChange(value, container) {
            console.log('Handling format change:', value);
            const customFormat = document.getElementById('customFormat');
            customFormat.style.display = value === 'custom' ? 'block' : 'none';

            if (value === 'custom') {
                customFormat.addEventListener('blur', function handler() {
                    if (this.value) {
                        console.log('Custom format added:', this.value);
                        addItem(container, this.value, 'removeFormat', this.value);
                        this.value = '';
                    }
                    this.removeEventListener('blur', handler);
                });
            } else {
                const text = document.getElementById('formatSelect').options[document.getElementById('formatSelect').selectedIndex].text;
                addItem(container, text, 'removeFormat', text);
            }
        }

        function handlePrintTypeChange(value, container) {
            console.log('Handling print type change:', value);
            const text = document.getElementById('printType').options[document.getElementById('printType').selectedIndex].text;
            addItem(container, text, 'removePrintType', text);
        }

        function handleMaterialChange(value, container) {
            console.log('Handling material change:', value);
            const customMaterial = document.getElementById('customMaterial');
            customMaterial.style.display = value === 'other' ? 'block' : 'none';

            if (value === 'other') {
                customMaterial.addEventListener('blur', function handler() {
                    if (this.value) {
                        console.log('Custom material added:', this.value);
                        addItem(container, this.value, 'removeMaterial', this.value);
                        this.value = '';
                    }
                    this.removeEventListener('blur', handler);
                });
            } else {
                const text = document.getElementById('materialSelect').options[document.getElementById('materialSelect').selectedIndex].text;
                addItem(container, text, 'removeMaterial', text);
            }
        }

        function handlePaperWeightChange(value, container) {
            console.log('Handling paper weight change:', value);
            const customPaperWeight = document.getElementById('customPaperWeight');
            customPaperWeight.style.display = value === 'other' ? 'block' : 'none';

            if (value === 'other') {
                customPaperWeight.addEventListener('blur', function handler() {
                    if (this.value) {
                        console.log('Custom paper weight added:', this.value);
                        addItem(container, `${this.value} г/м²`, 'removePaperWeight', `${this.value} г/м²`);
                        this.value = '';
                    }
                    this.removeEventListener('blur', handler);
                });
            } else {
                const text = document.getElementById('paperWeightSelect').options[document.getElementById('paperWeightSelect').selectedIndex].text;
                addItem(container, text, 'removePaperWeight', text);
            }
        }

        function handlePostPrintChange(value, container) {
            console.log('Handling post-print change:', value);
            const eyeletsFields = document.getElementById('eyeletsFields');
            const pocketsFields = document.getElementById('pocketsFields');
            const customPostPrint = document.getElementById('customPostPrint');
            eyeletsFields.style.display = value === 'eyelets' ? 'block' : 'none';
            pocketsFields.style.display = value === 'pockets' ? 'block' : 'none';
            customPostPrint.style.display = value === 'other' ? 'block' : 'none';

            if (value === 'pockets') {
                document.getElementById('noodleColor').addEventListener('change', function handler() {
                    console.log('Noodle color changed:', this.value);
                    const customNoodleColor = document.getElementById('customNoodleColor');
                    customNoodleColor.style.display = this.value === 'custom' ? 'block' : 'none';
                    if (this.value === 'custom') {
                        customNoodleColor.addEventListener('blur', function subHandler() {
                            if (this.value) {
                                const pocketSize = document.getElementById('pocketSize').value;
                                const text = `Кишені (Розмір: ${pocketSize || 'не вказано'} мм, Колір нитки: ${this.value})`;
                                console.log('Custom noodle color added:', text);
                                addItem(container, text, 'removePostPrint', text);
                                this.value = '';
                            }
                            this.removeEventListener('blur', subHandler);
                        });
                    } else if (this.value) {
                        const pocketSize = document.getElementById('pocketSize').value;
                        const text = `Кишені (Розмір: ${pocketSize || 'не вказано'} мм, Колір нитки: ${this.options[this.selectedIndex].text})`;
                        addItem(container, text, 'removePostPrint', text);
                        this.value = '';
                    }
                    this.removeEventListener('change', handler);
                });
            } else if (value === 'other') {
                customPostPrint.addEventListener('blur', function handler() {
                    if (this.value) {
                        console.log('Custom post-print added:', this.value);
                        addItem(container, this.value, 'removePostPrint', this.value);
                        this.value = '';
                    }
                    this.removeEventListener('blur', handler);
                });
            } else {
                const text = document.getElementById('postPrintSelect').options[document.getElementById('postPrintSelect').selectedIndex].text;
                addItem(container, text, 'removePostPrint', text);
            }
        }

        function addItem(container, text, removeFunctionName, identifier) {
            console.log('Adding item:', text);
            const itemDiv = document.createElement('div');
            itemDiv.className = 'selected-item';
            itemDiv.innerHTML = `<span>${text}</span><button type="button" class="remove-button" onclick="${removeFunctionName}(this, '${identifier.replace(/'/g, "\\'")}')">Видалити</button>`;
            container.appendChild(itemDiv);
        }

        window.removeProduct = function(button) { console.log('Removing product'); button.parentElement.remove(); };
        window.removePrintSides = function(button) { console.log('Removing print sides'); button.parentElement.remove(); };
        window.removeFormat = function(button) { console.log('Removing format'); button.parentElement.remove(); };
        window.removePrintType = function(button) { console.log('Removing print type'); button.parentElement.remove(); };
        window.removeMaterial = function(button) { console.log('Removing material'); button.parentElement.remove(); };
        window.removePaperWeight = function(button) { console.log('Removing paper weight'); button.parentElement.remove(); };
        window.removePostPrint = function(button) { console.log('Removing post-print'); button.parentElement.remove(); };

        function generateOrderTable() {
            console.log('Generating order table');
            const formData = {
                orderNumber: document.getElementById('orderNumber').textContent,
                orderDate: document.getElementById('orderDate').value,
                customer: document.querySelector('input[name="customer"]').value,
                contactPerson: document.querySelector('input[name="contact_person"]').value,
                phone: document.querySelector('input[name="phone"]').value,
                email: document.querySelector('input[name="email"]').value,
                filename: selectedFiles.map(file => file.name).join(', ') || 'Не вказано',
                product: getSelectedItems('selectedProducts'),
                printSides: getSelectedItems('selectedPrintSides'),
                quantity: document.querySelector('input[name="quantity"]').value,
                format: getSelectedItems('selectedFormats'),
                printType: getSelectedItems('selectedPrintTypes'),
                material: getSelectedItems('selectedMaterials'),
                paperWeight: getSelectedItems('selectedPaperWeights'),
                deadline: document.querySelector('input[name="deadline"]').value,
                postPrint: getSelectedItems('selectedPostPrint'),
                eyeletsQuantity: document.getElementById('eyeletsQuantity').value,
                eyeletsDistance: document.getElementById('eyeletsDistance').value,
                pocketSize: document.getElementById('pocketSize').value,
                notes: document.querySelector('textarea[name="notes"]').value || 'Немає'
            };

            return `
                <div class="order-table" style="font-family: Arial, sans-serif; padding: 20px; background: white; width: 800px; position: relative;">
                    <img src="https://printtmedia.github.io/printmediapro/Logo%20printmediapro.png" alt="Логотип PrintMediaPro" style="position: absolute; top: 20px; left: 20px; width: 150px; height: auto;">
                    <h2 style="text-align: center; color: #4F46E5; margin-top: 80px;">ФОРМА ЗАМОВЛЕННЯ №${formData.orderNumber}</h2>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                        <tr><th style="border: 1px solid #E5E7EB; padding: 8px; background-color: #F9FAFB;">Параметр</th><th style="border: 1px solid #E5E7EB; padding: 8px; background-color: #F9FAFB;">Значення</th></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Дата замовлення</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.orderDate}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Замовник</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.customer}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Контактна особа</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.contactPerson}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Телефон</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.phone}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Email</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.email}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Назва файлу</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.filename}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Назва продукту</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.product}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Сторони друку</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.printSides}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Кількість</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.quantity}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Формат</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.format}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Тип друку</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.printType}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Матеріал</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.material}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Щільність паперу</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.paperWeight}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Термін виконання</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.deadline}</td></tr>
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Післядрукарська обробка</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.postPrint}</td></tr>
                        ${formData.eyeletsQuantity ? `<tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Кількість люверсів</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.eyeletsQuantity}</td></tr>` : ''}
                        ${formData.eyeletsDistance ? `<tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Відстань між люверсами</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.eyeletsDistance} мм</td></tr>` : ''}
                        ${formData.pocketSize ? `<tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Розмір кишені</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.pocketSize} мм</td></tr>` : ''}
                        <tr><td style="border: 1px solid #E5E7EB; padding: 8px;">Примітки</td><td style="border: 1px solid #E5E7EB; padding: 8px;">${formData.notes}</td></tr>
                    </table>
                </div>
            `;
        }

        function getSelectedItems(containerId) {
            console.log('Getting selected items for:', containerId);
            const items = document.querySelectorAll(`#${containerId} .selected-item span`);
            return Array.from(items).map(item => item.textContent).join(', ') || 'Не вибрано';
        }

        function sendOrder() {
            console.log('Send Order clicked');
            try {
                const orderTable = generateOrderTable();
                const printWindow = window.open('', '_blank');
                if (!printWindow) throw new Error('Failed to open print window.');
                printWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head><title>Друкувати замовлення</title><style>@media print { body { margin: 0; padding: 0; } .order-table { width: 100%; } table, th, td { border: 1px solid black; font-size: 12pt; font-weight: 600; } .logo { display: block !important; position: absolute; top: 20px; left: 20px; width: 150px; height: auto; } }</style></head>
                    <body>${orderTable}</body>
                    </html>
                `);
                printWindow.document.close();
                printWindow.focus();
                setTimeout(() => {
                    printWindow.print();
                    printWindow.close();
                }, 500);
            } catch (error) {
                console.error('Error during printing:', error);
                alert('Не вдалося надрукувати замовлення.');
            }
        }

        function sendToGmail() {
            console.log('Send to Gmail clicked');
            try {
                if (typeof html2canvas === 'undefined') {
                    throw new Error('html2canvas is not loaded.');
                }
                const formData = { orderNumber: document.getElementById('orderNumber').textContent };
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.innerHTML = generateOrderTable();
                document.body.appendChild(tempDiv);

                html2canvas(tempDiv.querySelector('.order-table'), {
                    scale: 2,
                    useCORS: true,
                    logging: false
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png', 1.0);
                    const folderName = `Форма замовлення №${formData.orderNumber}`;
                    const fileName = `${folderName}.png`;

                    if (window.showDirectoryPicker) {
                        saveWithFolder(imgData, folderName, fileName).then(() => proceedWithEmail(folderName));
                    } else {
                        fallbackDownload(imgData, folderName, fileName);
                    }
                    document.body.removeChild(tempDiv);
                }).catch(error => {
                    console.error('html2canvas error:', error);
                    document.body.removeChild(tempDiv);
                    alert('Помилка створення зображення. Переконайтеся, що html2canvas завантажено правильно.');
                });
            } catch (error) {
                console.error('Error during sending:', error);
                alert('Не вдалося надіслати замовлення.');
            }
        }

        async function saveWithFolder(imgData, folderName, fileName) {
            console.log('Saving with folder:', folderName, fileName);
            try {
                const dirHandle = await window.showDirectoryPicker({ mode: 'readwrite' });
                const subDirHandle = await dirHandle.getDirectoryHandle(folderName, { create: true });
                const fileHandle = await subDirHandle.getFileHandle(fileName, { create: true });
                const writable = await fileHandle.createWritable();
                const response = await fetch(imgData);
                const blob = await response.blob();
                await writable.write(blob);
                await writable.close();
            } catch (error) {
                console.error('Error saving with folder:', error);
                fallbackDownload(imgData, folderName, fileName);
            }
        }

        function fallbackDownload(imgData, folderName, fileName) {
            console.log('Fallback download:', fileName);
            const link = document.createElement('a');
            link.href = imgData;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            proceedWithEmail(folderName);
        }

        function proceedWithEmail(folderName) {
            console.log('Proceeding with email for:', folderName);
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            const subject = `Форма замовлення №${folderName.split('№')[1]}`;
            if (isMobile) {
                window.location.href = `mailto:printmediapro@gmail.com?subject=${encodeURIComponent(subject)}`;
            } else {
                window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=printmediapro@gmail.com&su=${encodeURIComponent(subject)}`, '_blank');
            }
        }

        function showInstructions() {
            console.log('Show Instructions clicked');
            try {
                const instructionWindow = window.open('', '_blank');
                if (!instructionWindow) throw new Error('Failed to open instruction window.');
                instructionWindow.document.write(`
                    <!DOCTYPE html>
                    <html lang="uk">
                    <head>
                        <meta charset="UTF-8">
                        <title>Інструкції з використання форми</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; background-color: #f4f4f4; color: #333; }
                            h1 { color: #4F46E5; text-align: center; }
                            h2 { color: #6B7280; margin-top: 20px; }
                            p, li { font-size: 16px; }
                            ul { margin-left: 20px; }
                            .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
                        </style>
                    </head>
                    <body>
                        <div class="container">
                            <h1>Інструкції з використання "Форми замовлення друкарських послуг"</h1>
                            <p>Ця форма призначена для оформлення замовлень на друкарські послуги (візитки, банери, книги тощо). Ви можете заповнити поля, вибрати кілька варіантів там, де це можливо, і надрукувати замовлення або надіслати його на Gmail. Ось покрокова інструкція:</p>

                            <h2>1. Основна інформація</h2>
                            <ul>
                                <li><b>Дата замовлення</b>: Автоматично встановлюється поточна дата (наприклад, 23.04.2025). Змініть за потреби, вибравши дату з календаря.</li>
                                <li><b>Замовник</b>: Введіть назву компанії або ім’я замовника (наприклад, "ТОВ Ромашка" або "Іван Іванов").</li>
                                <li><b>Контактна особа</b>: Введіть ім’я контактної особи (наприклад, "Марія Петренко").</li>
                                <li><b>Телефон</b>: Введіть номер телефону у форматі +380XXXXXXXXX (наприклад, +380501234567). Використовуйте лише цифри та "+".</li>
                                <li><b>Email</b>: Введіть електронну пошту для зв’язку (наприклад, "maria@example.com").</li>
                                <li><b>Назва файлу</b>: Натисніть "Вибрати файл", щоб завантажити макети (PDF, JPG, PNG, DOCX). Ви можете вибрати кілька файлів (утримуйте Ctrl і клацайте файли у Windows або Command на Mac). Після вибору файли з’являться у списку нижче з кнопкою "Видалити". <b>Важливо</b>: Це поле лише відображає назви вибраних файлів у формі та у фінальній таблиці замовлення. Самі файли не додаються автоматично до електронного листа. Вам потрібно буде вручну прикріпити ці файли під час надсилання листа на Gmail (див. розділ "Надіслати на Gmail"). Щоб видалити файл зі списку, натисніть "Видалити" біля його назви.</li>
                            </ul>

                            <h2>2. Специфікація продукту</h2>
                            <p>Усі поля дозволяють вибирати кілька значень за потреби. Вибрані елементи з’являються у списку нижче з кнопкою "Видалити".</p>
                            <ul>
                                <li><b>Назва продукту</b>: Виберіть зі списку (наприклад, "Візитка", "Банер"). Після вибору елемент додається до списку (наприклад, "Візитка [Видалити]"). Ви можете додати кілька елементів. Щоб видалити, натисніть "Видалити".
                                    <ul>
                                        <li>Якщо вибрати "Журнал" або "Книга", з’явиться поле "Тип": виберіть "М’яка палітурка" або "Тверда палітурка" — додасться, наприклад, "Книга (М’яка палітурка) [Видалити]".</li>
                                        <li>Якщо вибрати "Календар", вкажіть "Тип календаря" ("Обкладинка" або "Внутрішній блок") та "Кількість сторінок" (наприклад, 12) — додасться як "Календар (Обкладинка, 12 сторінок) [Видалити]".</li>
                                        <li>Якщо вибрати "Інше", введіть назву (наприклад, "Наклейка") і натисніть Tab або клацніть поза полем — додасться як "Наклейка [Видалити]".</li>
                                    </ul>
                                </li>
                                <li><b>Сторони друку</b>: Виберіть "Односторонній (4+0)" або "Двосторонній (4+4)". Додасться до списку (наприклад, "4+0 [Видалити]"). Ви можете вибрати обидва варіанти. Видаліть помилки, натиснувши "Видалити".</li>
                                <li><b>Кількість</b>: Вкажіть кількість копій (наприклад, 100).</li>
                                <li><b>Формат</b>: Виберіть зі списку (наприклад, "A4") або "Власний формат" і вкажіть розміри (наприклад, "100x200 мм"). Додасться до списку (наприклад, "A4 [Видалити]"). Ви можете вибрати кілька форматів. Видаліть зайве, натиснувши "Видалити".</li>
                                <li><b>Тип друку</b>: Виберіть зі списку (наприклад, "Konica", "Широкоформатний друк"). Додасться до списку (наприклад, "Konica [Видалити]"). Ви можете вибрати кілька типів. Видаліть непотрібні, натиснувши "Видалити".</li>
                                <li><b>Матеріал</b>: Виберіть матеріал (наприклад, "Офсет") або "Інший матеріал" і вкажіть власний (наприклад, "Картон"). Додасться до списку. Видаліть за потреби.</li>
                                <li><b>Щільність паперу</b>: Виберіть зі списку (наприклад, "80 г/м²") або "Інша" і вкажіть значення (наприклад, "200"). Додасться до списку (наприклад, "80 г/м² [Видалити]"). Ви можете вибрати кілька щільностей. Видаліть зайве.</li>
                                <li><b>Термін виконання</b>: Виберіть дату з календаря (наприклад, 30.04.2025).</li>
                            </ul>

                            <h2>3. Післядрукарська обробка</h2>
                            <ul>
                                <li><b>Післядрукарська обробка</b>: Виберіть тип обробки (наприклад, "Глянцева ламінація"). Додасться до списку. Ви можете вибрати кілька типів.
                                    <ul>
                                        <li>Якщо вибрати "Люверси", вкажіть "Кількість люверсів" (наприклад, 4) та "Відстань між люверсами" (наприклад, 100 мм) — ці дані включаться до таблиці.</li>
                                        <li>Якщо вибрати "Кишені", вкажіть "Розмір кишені" (наприклад, "100x50") та "Колір нитки" (наприклад, "Червоний" або "Власний" і ваш колір, наприклад, "Срібний") — додасться як "Кишені (Розмір: 100x50 мм, Колір нитки: Червоний) [Видалити]".</li>
                                        <li>Якщо вибрати "Інше", введіть тип обробки (наприклад, "Власна висічка") і натисніть Tab або клацніть поза полем — додасться як "Власна висічка [Видалити]".</li>
                                    </ul>
                                    Видаліть непотрібні елементи, натиснувши "Видалити".
                                </li>
                            </ul>

                            <h2>4. Примітки</h2>
                            <ul>
                                <li><b>Примітки</b>: Введіть додаткові побажання (наприклад, "Термінове замовлення"). Залиште порожнім, якщо не потрібно.</li>
                            </ul>

                            <h2>5. Дії з замовленням</h2>
                            <ul>
                                <li><b>Друкувати форму замовлення</b>: Натисніть, щоб відкрити вікно з таблицею замовлення. Натисніть "Друк" у браузері, щоб надіслати на принтер.</li>
                                <li><b>Надіслати на Gmail</b>: Натисніть, щоб зберегти PNG-файл таблиці в папці з назвою "Форма замовлення №XXXXXX". Потім відкриється Gmail (на комп’ютері) або поштовий додаток (на мобільному пристрої) із заповненою адресою printmediapro@gmail.com і темою "Форма замовлення №XXXXXX". <b>Важливо</b>: Вам потрібно вручну прикріпити файли, які ви вибрали в полі "Назва файлу", а також PNG-файл замовлення ("Форма замовлення №XXXXXX.png"). Для цього:
                                    <ul>
                                        <li>У відкритому вікні Gmail натисніть на значок скріпки ("Прикріпити файли").</li>
                                        <li>Виберіть файли, які ви вказали в полі "Назва файлу" (наприклад, макети у форматі PDF, JPG, PNG або DOCX).</li>
                                        <li>Також знайдіть і виберіть збережений PNG-файл замовлення ("Форма замовлення №XXXXXX.png") з папки, де він був збережений.</li>
                                        <li>Після прикріплення всіх файлів натисніть "Надіслати".</li>
                                    </ul>
                                    Якщо Gmail не відкривається, вручну надішліть лист на printmediapro@gmail.com, прикріпивши всі необхідні файли.
                                </li>
                                <li><b>Інструкції</b>: Натисніть, щоб відкрити це вікно з інструкціями.</li>
                            </ul>

                            <h2>Поради</h2>
                            <ul>
                                <li>Перевірте дані перед друком або надсиланням.</li>
                                <li>Якщо ви помилилися у виборі, видаліть елемент, натиснувши "Видалити" — не потрібно перезавантажувати сторінку.</li>
                                <li>На мобільних пристроях форма займає всю ширину екрана. Прокручуйте форму, щоб побачити всі поля та кнопки.</li>
                                <li>Переконайтеся, що ви прикріпили всі необхідні файли перед надсиланням листа, інакше одержувач не зможе обробити замовлення.</li>
                            </ul>

                            <p>Тепер ви готові використовувати форму без помилок!</p>
                        </div>
                    </body>
                    </html>
                `);
                instructionWindow.document.close();
            } catch (error) {
                console.error('Instruction error:', error);
                alert('Не вдалося відкрити інструкції.');
            }
        }
    </script>
</body>
</html>